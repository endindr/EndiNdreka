"use strict";(globalThis.webpackChunk_github_ui_github_ui=globalThis.webpackChunk_github_ui_github_ui||[]).push([["packages_use-client-value_use-client-value_ts-packages_create-branch-button_CreateBranchButton_tsx"],{11418:(e,t,r)=>{let n;r.d(t,{H:()=>M});var a=r(35750),s=r(18150),i=r(85242),o=r(88243),l=r(16213),c=r(10204),u=new WeakMap,d=new WeakSet;let AliveSession=class AliveSession extends c.ib{constructor(e,t,r,n,a){super(e,()=>(0,o._)(this,d,h).call(this),r,n,void 0,a),(0,l._)(this,d),(0,s._)(this,u,{writable:!0,value:void 0}),(0,i._)(this,u,t)}};function h(){return p((0,a._)(this,u))}async function p(e){let t=await m(e);return t&&t.url&&t.token?f(t.url,t.token):null}async function m(e){let t=await fetch(e,{headers:{Accept:"application/json"}});if(t.ok)return t.json();if(404===t.status)return null;throw Error("fetch error")}async function f(e,t){let r=await fetch(e,{method:"POST",mode:"same-origin",headers:{"Scoped-CSRF-Token":t}});if(r.ok)return r.text();throw Error("fetch error")}var b=r(70170),v=r(34095),w=r(82075),y=r(23683),_=r(69599);function x(e,{channel:t,type:r,data:n}){for(let a of e)a.dispatchEvent(new CustomEvent(`socket:${r}`,{bubbles:!1,cancelable:!1,detail:{name:t,data:n}}))}var g=new WeakMap,N=new WeakMap,k=new WeakMap,C=new WeakMap,j=new WeakMap,T=new WeakSet;let S=class AliveSessionProxy{subscribe(e){let t=(0,a._)(this,N).add(...e);t.length&&(0,a._)(this,g).port.postMessage({subscribe:t});let r=new Set(t.map(e=>e.name)),n=e.reduce((e,t)=>{let n=t.topic.name;return(0,c.JR)(n)&&!r.has(n)&&e.add(n),e},new Set);n.size&&(0,a._)(this,g).port.postMessage({requestPresence:Array.from(n)})}unsubscribeAll(...e){let t=(0,a._)(this,N).drain(...e);t.length&&(0,a._)(this,g).port.postMessage({unsubscribe:t});let r=(0,a._)(this,k).removeSubscribers(e);this.sendPresenceMetadataUpdate(r)}updatePresenceMetadata(e){let t=new Set;for(let r of e)(0,a._)(this,k).setMetadata(r),t.add(r.channelName);this.sendPresenceMetadataUpdate(t)}sendPresenceMetadataUpdate(e){if(!e.size)return;let t=[];for(let r of e)t.push({channelName:r,metadata:(0,a._)(this,k).getChannelMetadata(r)});(0,a._)(this,g).port.postMessage({updatePresenceMetadata:t})}online(){(0,a._)(this,g).port.postMessage({online:!0})}offline(){(0,a._)(this,g).port.postMessage({online:!1})}hangup(){(0,a._)(this,g).port.postMessage({hangup:!0})}constructor(e,t,r,n,u,d){(0,l._)(this,T),(0,s._)(this,g,{writable:!0,value:void 0}),(0,s._)(this,N,{writable:!0,value:new c.m0}),(0,s._)(this,k,{writable:!0,value:new c.VH}),(0,s._)(this,C,{writable:!0,value:void 0}),(0,s._)(this,j,{writable:!0,value:new Map}),(0,i._)(this,C,u),(0,i._)(this,g,new SharedWorker(`${e}?module=true`,{name:`github-socket-worker-v3-${n}`,type:"module"})),(0,a._)(this,g).port.onmessage=({data:e})=>(0,o._)(this,T,P).call(this,e),(0,a._)(this,g).port.postMessage({connect:{url:t,refreshUrl:r,options:d}})}};function P(e){let{channel:t}=e;if("presence"===e.type){let r=(0,a._)(this,j).get(t);r||(r=(0,b.s)((e,r)=>{(0,a._)(this,C).call(this,e,r),(0,a._)(this,j).delete(t)},100),(0,a._)(this,j).set(t,r)),r((0,a._)(this,N).subscribers(t),e);return}(0,a._)(this,C).call(this,(0,a._)(this,N).subscribers(t),e)}async function B(){let e=function(){let e=document.head.querySelector("link[rel=shared-web-socket-src]")?.getAttribute("href");return e&&e.startsWith("/")?e:null}();if(!e)return;let t=document.head.querySelector("link[rel=shared-web-socket]")?.href??null;if(!t)return;let r=document.head.querySelector("link[rel=shared-web-socket]")?.getAttribute("data-refresh-url")??null;if(!r)return;let n=document.head.querySelector("link[rel=shared-web-socket]")?.getAttribute("data-session-id")??null;if(!n)return;let a=(()=>{let a=(0,_.G7)("alive_legacy_retries")?{socketPolicy:{timeout:4e3,attempts:7}}:{};if(!(0,y.nr)()&&"SharedWorker"in window&&"true"!==(0,w.A)("localStorage").getItem("bypassSharedWorker"))try{return new S(e,t,r,n,x,a)}catch{}return new AliveSession(t,r,!1,x,a)})();return window.addEventListener("online",()=>a.online()),window.addEventListener("offline",()=>a.offline()),window.addEventListener("pagehide",()=>{"hangup"in a&&a.hangup()}),a}async function A(){return await v.G,B()}function M(){return n||(n=A())}},20263:(e,t,r)=>{r.d(t,{BC:()=>l,JU:()=>u,Pk:()=>o});var n=r(74848),a=r(87448),s=r(99418),i=r(96540);let o=d(a.az),l=d(a.EY),c=(0,i.forwardRef)((e,t)=>(0,n.jsx)("div",{ref:t,...e}));c.displayName="Div";let u=d(c);function d(e){let t=(0,i.forwardRef)((t,r)=>{let{sanitizedHTML:a,props:i}=function(e){let{html:t,domPurifyConfig:r,...n}=e,a={...r,RETURN_DOM:!1,RETURN_DOM_FRAGMENT:!1};return{sanitizedHTML:s.default.sanitize(t,a),props:n}}(t);return(0,n.jsx)(e,{ref:r,...i,dangerouslySetInnerHTML:{__html:a}})});return t.displayName=`UnsafeHTML${e.displayName||e.name}`,t}try{u.displayName||(u.displayName="UnsafeHTMLDiv")}catch{}},33303:(e,t,r)=>{function n(){return Promise.resolve()}function a(){return new Promise(window.requestAnimationFrame)}async function s(e,t){let r,n=new Promise(t=>{r=self.setTimeout(t,e)});if(!t)return n;try{var a;await Promise.race([n,(a=t,new Promise((e,t)=>{let r=Error("aborted");r.name="AbortError",a.aborted?t(r):a.addEventListener("abort",()=>t(r))}))])}catch(e){throw self.clearTimeout(r),e}}function i(e){let t=[];return function(r){t.push(r),1===t.length&&queueMicrotask(()=>{let r=t.slice(0);t.length=0,e(r)})}}r.d(t,{G$:()=>a,k2:()=>n,rK:()=>i,uk:()=>s})},40235:(e,t,r)=>{r.d(t,{x:()=>p});var n,a=r(96540),s=r(70263),i=r(11418),o=r(73056),l=r(74848),c=r(10204);let u=(0,a.createContext)(null),d=null;function h(e,t){let r=c.KK.parse(e);if(!r)throw Error(`Invalid channel name. Did you forget to sign it with \`signChannel("${e}")\`?`);return d||(d=new c.m0),d.add({topic:r,subscriber:t}),{unsubscribe:()=>{d?.delete({topic:r,subscriber:t})}}}try{u.displayName||(u.displayName="AliveTestContext")}catch{}try{(n=function({children:e,initialMessages:t}){return(0,a.useEffect)(()=>{let e=[];if(t)for(let[r,n]of t){let t=window.setTimeout(()=>{var e=r,t=n;if(null===d)throw Error('Test helper `dispatchAliveTestMessage` called outside `AliveTestProvider`. Please wrap your component under test in `AliveTestProvider` from "@github-ui/use-alive/test-utils".');for(let r of Array.from(d.subscribers(e)))r(t)},0);e.push(t)}return()=>{for(let t of(d=null,e))window.clearTimeout(t)}}),(0,l.jsx)(u.Provider,{value:h,children:e})}).displayName||(n.displayName="AliveTestProvider")}catch{}function p(e,t){let r=(0,s.A)(),n=(0,a.useContext)(u);(0,a.useEffect)(()=>{let a=()=>{},s=!1;return async function(){if(e){if("function"==typeof n){let r=await n(e,t);r&&(a=r.unsubscribe);return}try{let n=await (0,i.H)();if(s)return;let l=(0,o.$)(n,e,t);l?.unsubscribe&&(r()?a=l.unsubscribe:l.unsubscribe())}catch(e){console.error(e)}}}(),()=>{s=!0,a()}},[e,t,r,n])}},40260:(e,t,r)=>{r.d(t,{D:()=>n});function n(e){if("clipboard"in navigator)return navigator.clipboard.writeText(e);let t=document.body;if(!t)return Promise.reject(Error());let r=function(e){let t=document.createElement("pre");return t.style.width="1px",t.style.height="1px",t.style.position="fixed",t.style.top="5px",t.textContent=e,t}(e);return t.appendChild(r),!function(e){if("clipboard"in navigator)return navigator.clipboard.writeText(e.textContent||"");let t=getSelection();if(null==t)return Promise.reject(Error());t.removeAllRanges();let r=document.createRange();r.selectNodeContents(e),t.addRange(r),document.execCommand("copy"),t.removeAllRanges(),Promise.resolve()}(r),t.removeChild(r),Promise.resolve()}},51416:(e,t,r)=>{r.d(t,{F:()=>C});var n=r(74848),a=r(96540),s=r(21373),i=r(86877),o=r(15220),l=r(66990),c=r(96379),u=r(65025),d=r(98755),h=r(99511);let p={NewBranchNameInputGroup:"NewBranchName-module__NewBranchNameInputGroup--hhSjt",TextInput:"NewBranchName-module__TextInput--lqzqa",copyButtonContainer:"NewBranchName-module__copyButtonContainer--YlH4s",CopyToClipboardButton:"NewBranchName-module__CopyToClipboardButton--XbiHw"};var m=r(34164);let f=(0,a.forwardRef)(function({newBranchName:e,setNewBranchName:t},r){return(0,n.jsxs)(i.A,{children:[(0,n.jsx)(i.A.Label,{children:"New branch name"}),(0,n.jsxs)("div",{className:p.NewBranchNameInputGroup,children:[(0,n.jsx)(h.A,{block:!0,className:(0,m.$)("color-bg-subtle",p.TextInput),value:e,onChange:e=>t(e.target.value),ref:r}),(0,n.jsx)("div",{className:(0,m.$)("color-bg-subtle",p.copyButtonContainer),children:(0,n.jsx)(d.T,{tooltipProps:{direction:"nw"},textToCopy:e,ariaLabel:"Copy to clipboard",className:(0,m.$)("pt-1",p.CopyToClipboardButton)})})]})]})});try{f.displayName||(f.displayName="NewBranchName")}catch{}var b=r(31604),v=r(5524),w=r(38621);let y={ForkPickerButtonContent:"ForkPicker-module__ForkPickerButtonContent--twfKB",repoIconContainer:"ForkPicker-module__repoIconContainer--OHc0s",repoNameContainer:"ForkPicker-module__repoNameContainer--QvaEf",repoNameText:"ForkPicker-module__repoNameText--n_Uv1"};function _(e){return`${e.ownerLogin}/${e.name}`}function x({isForkSourceOpen:e,setForkSourceOpen:t,repoSource:r,setRepoSource:i,repository:o,repositoryParent:l,setDefaultBranch:c,setBranchSource:u}){return(0,n.jsxs)(a.Fragment,{children:[(0,n.jsx)("span",{className:"note text-small mt-0",children:"Choose from this fork or its upstream repository."}),(0,n.jsx)(b.T,{open:e,overlayProps:{role:"dialog",width:"medium"},onOpen:()=>t(!0),onClose:()=>t(!1),renderAnchor:e=>(0,n.jsx)(s.Q,{...e,trailingVisual:w.TriangleDownIcon,"aria-label":_(r),"data-testid":"anchor-button",children:(0,n.jsxs)("div",{className:y.ForkPickerButtonContent,children:[(0,n.jsx)("div",{className:y.repoIconContainer,children:(0,n.jsx)(w.RepoIcon,{size:"small"})}),(0,n.jsx)("div",{className:y.repoNameContainer,children:(0,n.jsxs)("span",{className:y.repoNameText,children:["\xa0",`${_(r)}`]})})]})}),focusZoneSettings:{disabled:!0},children:(0,n.jsx)("div",{"data-testid":"overlay-content",id:"selectPanel",children:(0,n.jsxs)(v.l,{selectionVariant:"single",children:[(0,n.jsx)(v.l.Item,{selected:r.id===l.id,onSelect:()=>{i(l),c(l.defaultBranch),u(l.defaultBranch),t(!1)},children:`${l.ownerLogin}/${l.name}`}),(0,n.jsx)(v.l.Item,{selected:r.id===o.id,onSelect:()=>{i(o),c(o.defaultBranch),u(o.defaultBranch),t(!1)},children:`${o.ownerLogin}/${o.name}`})]})})})]})}try{x.displayName||(x.displayName="ForkPicker")}catch{}var g=r(40235),N=r(88934);function k({channel:e="",onUpdate:t}){let[,r]=(0,N.ok)(),n=(0,a.useCallback)(e=>{t(e),r(t=>(t.set("branch_event",encodeURIComponent(e.reason)),t))},[t,r]);return(0,g.x)(e,n),null}try{k.displayName||(k.displayName="LiveBranches")}catch{}function C({branchListCacheKey:e,repository:t,repositoryParent:r,createUrl:d,helpUrl:h,liveReload:p}){let[m,b]=(0,a.useState)(!1),[v,w]=(0,a.useState)(t.defaultBranch),[y,_]=(0,a.useState)(t.defaultBranch),[g,N]=(0,a.useState)(""),[C,j]=(0,a.useState)(t),[T,S]=(0,a.useState)(!1),[P,B]=(0,a.useState)(void 0),[A,M]=(0,a.useState)(void 0),[E,F]=(0,a.useState)(!1),[R,I]=(0,a.useState)(!1),[L,$]=(0,a.useState)(void 0),U=(0,a.useRef)(null),H=(0,a.useRef)(null);function O(){B(void 0),M(void 0),N(""),F(!1)}async function W(){if(!R){I(!0);let e=new FormData;e.append("name",g),e.append("branch",y),r&&e.append("repo",C.id.toString()),e.append("send_response_as_json","true");let t=await (0,c.DI)(d,{method:"post",body:e,headers:{Accept:"application/json"}}),n=await t.json();if(t.ok)O(),b(!1),p&&n.channel?$(n.channel):window.location.reload();else{let e=n.error;e?.includes("Repository rule violations found")?(M(void 0),B(e.replace("Repository rule violations found","").trim().split(`

`).slice(0,3))):e&&(B(void 0),M(e.trim()))}I(!1)}}return(0,a.useEffect)(()=>{m&&requestAnimationFrame(()=>H.current?.focus())},[m]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.Q,{ref:U,variant:"primary",className:"ml-3",onClick:()=>{O(),b(!0)},children:"New branch"}),m&&(0,n.jsx)(o.l,{title:"Create a branch",width:"large",onClose:()=>{b(!1),O()},returnFocusRef:U,footerButtons:E?[]:[{content:"Cancel",buttonType:"normal",onClick:()=>{b(!1),O()}},{content:"Create new branch",buttonType:"primary",onClick:W}],children:(0,n.jsxs)(n.Fragment,{children:[(P||A)&&(0,n.jsx)(u.r,{prefix:"Unable to create branch:",errorMessageUsingPrefix:P?"Please address the rule violations and try again.":void 0,errorMessageNotUsingPrefix:A,ruleErrors:P,helpUrl:h}),(0,n.jsx)("form",{onSubmit:e=>{e.preventDefault(),W()},children:(0,n.jsx)(f,{newBranchName:g,setNewBranchName:N,ref:H})}),(0,n.jsx)("div",{className:"mt-3",children:(0,n.jsxs)(i.A,{children:[(0,n.jsx)(i.A.Label,{className:"mb-0",children:"Source"}),r&&(0,n.jsx)(x,{isForkSourceOpen:T,setForkSourceOpen:S,repoSource:C,setRepoSource:j,repository:t,repositoryParent:r,setDefaultBranch:w,setBranchSource:_}),(0,n.jsx)(l.PI,{currentCommitish:y,defaultBranch:v,owner:C.ownerLogin,repo:C.name,canCreate:!1,cacheKey:e,selectedRefType:"branch",onSelectItem:e=>_(e),closeOnSelect:!0,types:["branch"],hideShowAll:!0})]})})]})}),L?(0,n.jsx)(k,{channel:L,onUpdate:()=>$(void 0)}):null]})}try{C.displayName||(C.displayName="CreateBranchButton")}catch{}},54571:(e,t,r)=>{r.d(t,{I:()=>i});var n=r(96540),a=r(88431),s=r(76629);function i(e,t,r=[]){let o=(0,n.useCallback)(e,r),l=(0,s.BP)(),c=(0,n.useRef)(l===s.O8.ClientRender),[u,d]=(0,n.useState)(()=>l===s.O8.ClientRender?o():t),h=(0,n.useCallback)(()=>{d(o)},[o]);return(0,a.N)(()=>{c.current||d(o),c.current=!1},[o,...r]),[u,h]}},65025:(e,t,r)=>{r.d(t,{r:()=>d});var n=r(74848),a=r(38621),s=r(72511),i=r(57352),o=r(10095),l=r(20263);let c={Flash:"FlashError-module__Flash--fKR6V",SafeHTMLText:"FlashError-module__SafeHTMLText--J8lL9",Link:"FlashError-module__Link--doNrG",ruleViolationsTitle:"FlashError-module__ruleViolationsTitle--rHHNU",ruleViolationRow:"FlashError-module__ruleViolationRow--ekTTM",Octicon:"FlashError-module__Octicon--U4ZWa",ruleViolationText:"FlashError-module__ruleViolationText--Oe758"};var u=r(34164);function d({prefix:e,errorMessageUsingPrefix:t,errorMessageNotUsingPrefix:r,hideRuleErrorsTitle:d,ruleErrors:h,helpUrl:p,flashRef:m}){let f=(h?.length||0)>0;return t||r?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.A,{id:"flash",variant:"danger",className:(0,u.$)("d-flex flex-items-center flex-justify-between",c.Flash),tabIndex:-1,ref:m,children:t?(0,n.jsxs)("div",{children:[e," ",(0,n.jsx)(l.BC,{className:c.SafeHTMLText,html:t}),f&&p&&(0,n.jsx)(i.A,{href:`${p}/repositories/configuring-branches-and-merges-in-your-repository/managing-rulesets/about-rulesets`,className:c.Link,children:"Learn more about rulesets."})]}):r&&(0,n.jsx)("div",{children:r})}),f&&(0,n.jsxs)("div",{className:c.Flash,children:[!d&&(0,n.jsx)("div",{className:c.ruleViolationsTitle,children:"Repository rule violations found:"}),h?.map(e=>(0,n.jsxs)("div",{className:c.ruleViolationRow,children:[(0,n.jsx)(o.A,{icon:a.XCircleFillIcon,size:16,className:c.Octicon}),(0,n.jsx)("div",{className:c.ruleViolationText,children:e})]},e))]})]}):null}try{d.displayName||(d.displayName="FlashError")}catch{}},73056:(e,t,r)=>{r.d(t,{$:()=>i});var n=r(10204),a=r(33303);let s=new WeakMap;function i(e,t,r){let i;if(!e)throw Error("Not connected to alive");if(!t)throw Error("No channel name");let o=n.KK.parse(t);if(!o)throw Error("Invalid channel name");let l={subscriber:{dispatchEvent:e=>{e instanceof CustomEvent&&r(e.detail.data)}},topic:o},c=((i=s.get(e))||(i={subscribe:(0,a.rK)(t=>e.subscribe(t.flat())),unsubscribeAll:(0,a.rK)(t=>e.unsubscribeAll(...t))},s.set(e,i)),i);return c.subscribe([l]),{unsubscribe:()=>c.unsubscribeAll(l.subscriber)}}},98755:(e,t,r)=>{r.d(t,{T:()=>p});var n=r(74848),a=r(70263),s=r(38621),i=r(26108),o=r(96540),l=r(34164),c=r(87448),u=r(4559),d=r(40260);let h={tooltip:"CopyToClipboardButton-module__tooltip--HDUYz"};function p({icon:e=s.CopyIcon,size:t="medium",onCopy:r,textToCopy:p,tooltipProps:m,variant:f="invisible",ariaLabel:b,className:v,disabled:w,...y}){let[_,x]=o.useState(!1),g=(0,a.A)(),N=b??`Copy "${p}" to clipboard`,k=_?"Copied!":N,C={size:t,variant:f,onClick:()=>{x(!0),(0,u.i)("Copied!"),(0,d.D)(p),r?.(),setTimeout(()=>g()&&x(!1),2e3)},icon:_?s.CheckIcon:e,className:(0,l.$)(_?"color-fg-success":void 0,v),...y},j=(0,o.useId)();return w?(0,n.jsx)(i.K,{...C,"aria-label":N,disabled:!0}):(0,n.jsx)(c.m_,{text:k,"aria-label":N,type:"label",id:j,"aria-hidden":!0,...m,className:(0,l.$)(h.tooltip,m?.className),children:(0,n.jsx)(i.K,{...C,"aria-labelledby":j})})}try{p.displayName||(p.displayName="CopyToClipboardButton")}catch{}}}]);
//# sourceMappingURL=packages_use-client-value_use-client-value_ts-packages_create-branch-button_CreateBranchButton_tsx-43a0e9563303.js.map